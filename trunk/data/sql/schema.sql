CREATE TABLE categoria_translation (id BIGINT, name VARCHAR(100) NOT NULL, lang CHAR(2), PRIMARY KEY(id, lang)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE categoria (id BIGINT AUTO_INCREMENT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE comoseentero_translation (id BIGINT, name VARCHAR(80) NOT NULL, lang CHAR(2), PRIMARY KEY(id, lang)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE comoseentero (id BIGINT AUTO_INCREMENT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE creditcard (id BIGINT AUTO_INCREMENT, usuario_id BIGINT NOT NULL, numero BIGINT NOT NULL, nombre VARCHAR(80) NOT NULL, codigo BIGINT NOT NULL, fechavencimiento VARCHAR(7) NOT NULL, tipo BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX usuario_id_idx (usuario_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE cupon (id BIGINT AUTO_INCREMENT, name VARCHAR(50) NOT NULL, descuento DOUBLE(18, 2) NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE direccion (id BIGINT AUTO_INCREMENT, usuario_id BIGINT NOT NULL, alias VARCHAR(80) NOT NULL, direccion VARCHAR(200) NOT NULL, ciudad VARCHAR(100) NOT NULL, estado VARCHAR(20) NOT NULL, zip BIGINT NOT NULL, lon DOUBLE(18, 2) DEFAULT 0 NOT NULL, lat DOUBLE(18, 2) DEFAULT 0 NOT NULL, facturacion TINYINT(1) DEFAULT '0' NOT NULL, ruta BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX usuario_id_idx (usuario_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE ingrediente_translation (id BIGINT, name VARCHAR(70) NOT NULL, lang CHAR(2), PRIMARY KEY(id, lang)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE ingrediente (id BIGINT AUTO_INCREMENT, tipoingrediente_id BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX tipoingrediente_id_idx (tipoingrediente_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE ingredientes (id BIGINT AUTO_INCREMENT, plato_id BIGINT NOT NULL, ingrediente_id BIGINT NOT NULL, grms DOUBLE(18, 2), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX plato_id_idx (plato_id), INDEX ingrediente_id_idx (ingrediente_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE itemsemana (id BIGINT AUTO_INCREMENT, menu_id BIGINT NOT NULL, semana_id BIGINT NOT NULL, dia BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX semana_id_idx (semana_id), INDEX menu_id_idx (menu_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE itemsmenu (id BIGINT AUTO_INCREMENT, menu_id BIGINT NOT NULL, plato_id BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX menu_id_idx (menu_id), INDEX plato_id_idx (plato_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE itemsorden (id BIGINT AUTO_INCREMENT, orden_id BIGINT NOT NULL, menu_id BIGINT, plato_id BIGINT, cantidad BIGINT DEFAULT 1 NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX menu_id_idx (menu_id), INDEX plato_id_idx (plato_id), INDEX orden_id_idx (orden_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE menu (id BIGINT AUTO_INCREMENT, precio DOUBLE(18, 2) NOT NULL, categoria_id BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX categoria_id_idx (categoria_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE orden (id BIGINT AUTO_INCREMENT, usuario_id BIGINT NOT NULL, placedby_id BIGINT NOT NULL, direccion_id BIGINT NOT NULL, monto DOUBLE(18, 2) NOT NULL, status VARCHAR(20) NOT NULL, autorizacion VARCHAR(25) DEFAULT 'pendiente' NOT NULL, referencia VARCHAR(30) DEFAULT 'pendiente' NOT NULL, avsresultado VARCHAR(20), cvv2 VARCHAR(20), mensajeerror VARCHAR(30), cupon_id BIGINT, manual TINYINT(1) DEFAULT '0', pago TINYINT(1) DEFAULT '0', created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX direccion_id_idx (direccion_id), INDEX cupon_id_idx (cupon_id), INDEX usuario_id_idx (usuario_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE plato_translation (id BIGINT, name VARCHAR(70) NOT NULL, description VARCHAR(200) NOT NULL, lang CHAR(2), PRIMARY KEY(id, lang)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE plato (id BIGINT AUTO_INCREMENT, disponible TINYINT(1) DEFAULT '1' NOT NULL, precio DOUBLE(18, 2) NOT NULL, imagen VARCHAR(100), calorias FLOAT(18, 2) DEFAULT 0 NOT NULL, proteinas FLOAT(18, 2) DEFAULT 0 NOT NULL, grasas FLOAT(18, 2) DEFAULT 0 NOT NULL, carbohidratos FLOAT(18, 2) DEFAULT 0 NOT NULL, colesterol FLOAT(18, 2) DEFAULT 0 NOT NULL, sodio FLOAT(18, 2) DEFAULT 0 NOT NULL, weightwatcher BIGINT DEFAULT 0 NOT NULL, categoria_id BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX categoria_id_idx (categoria_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE preferenciastipoingrediente (id BIGINT AUTO_INCREMENT, usuario_id BIGINT NOT NULL, tipoingrediente_id BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX usuario_id_idx (usuario_id), INDEX tipoingrediente_id_idx (tipoingrediente_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE semana (id BIGINT AUTO_INCREMENT, fecha_inicio DATE NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE testimonio (id BIGINT AUTO_INCREMENT, usuario_id BIGINT NOT NULL, mensaje TEXT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX usuario_id_idx (usuario_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE tipoingrediente_translation (id BIGINT, name VARCHAR(100) NOT NULL, lang CHAR(2), PRIMARY KEY(id, lang)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE tipoingrediente (id BIGINT AUTO_INCREMENT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE usuario (id BIGINT AUTO_INCREMENT, tipo BIGINT DEFAULT 0 NOT NULL, nombre VARCHAR(120) NOT NULL, apellido VARCHAR(120) NOT NULL, email VARCHAR(60) NOT NULL UNIQUE, clave VARCHAR(60) NOT NULL, birthday DATE NOT NULL, telefono1 BIGINT NOT NULL, telefono2 BIGINT, sexo TINYINT(1) NOT NULL, cupon VARCHAR(30), comoseentero_id BIGINT NOT NULL, activo TINYINT(1) DEFAULT '1' NOT NULL, recurrente TINYINT(1) DEFAULT '0' NOT NULL, nota_usuario TEXT NOT NULL, nota_administrador TEXT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX comoseentero_id_idx (comoseentero_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
ALTER TABLE categoria_translation ADD CONSTRAINT categoria_translation_id_categoria_id FOREIGN KEY (id) REFERENCES categoria(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE comoseentero_translation ADD CONSTRAINT comoseentero_translation_id_comoseentero_id FOREIGN KEY (id) REFERENCES comoseentero(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE creditcard ADD CONSTRAINT creditcard_usuario_id_usuario_id FOREIGN KEY (usuario_id) REFERENCES usuario(id);
ALTER TABLE direccion ADD CONSTRAINT direccion_usuario_id_usuario_id FOREIGN KEY (usuario_id) REFERENCES usuario(id) ON DELETE CASCADE;
ALTER TABLE ingrediente_translation ADD CONSTRAINT ingrediente_translation_id_ingrediente_id FOREIGN KEY (id) REFERENCES ingrediente(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE ingrediente ADD CONSTRAINT ingrediente_tipoingrediente_id_tipoingrediente_id FOREIGN KEY (tipoingrediente_id) REFERENCES tipoingrediente(id);
ALTER TABLE ingredientes ADD CONSTRAINT ingredientes_plato_id_plato_id FOREIGN KEY (plato_id) REFERENCES plato(id) ON DELETE CASCADE;
ALTER TABLE ingredientes ADD CONSTRAINT ingredientes_ingrediente_id_ingrediente_id FOREIGN KEY (ingrediente_id) REFERENCES ingrediente(id);
ALTER TABLE itemsemana ADD CONSTRAINT itemsemana_semana_id_semana_id FOREIGN KEY (semana_id) REFERENCES semana(id) ON DELETE CASCADE;
ALTER TABLE itemsemana ADD CONSTRAINT itemsemana_menu_id_menu_id FOREIGN KEY (menu_id) REFERENCES menu(id);
ALTER TABLE itemsmenu ADD CONSTRAINT itemsmenu_plato_id_plato_id FOREIGN KEY (plato_id) REFERENCES plato(id);
ALTER TABLE itemsmenu ADD CONSTRAINT itemsmenu_menu_id_menu_id FOREIGN KEY (menu_id) REFERENCES menu(id) ON DELETE CASCADE;
ALTER TABLE itemsorden ADD CONSTRAINT itemsorden_plato_id_plato_id FOREIGN KEY (plato_id) REFERENCES plato(id);
ALTER TABLE itemsorden ADD CONSTRAINT itemsorden_orden_id_orden_id FOREIGN KEY (orden_id) REFERENCES orden(id);
ALTER TABLE itemsorden ADD CONSTRAINT itemsorden_menu_id_menu_id FOREIGN KEY (menu_id) REFERENCES menu(id);
ALTER TABLE menu ADD CONSTRAINT menu_categoria_id_categoria_id FOREIGN KEY (categoria_id) REFERENCES categoria(id);
ALTER TABLE orden ADD CONSTRAINT orden_usuario_id_usuario_id FOREIGN KEY (usuario_id) REFERENCES usuario(id);
ALTER TABLE orden ADD CONSTRAINT orden_direccion_id_direccion_id FOREIGN KEY (direccion_id) REFERENCES direccion(id);
ALTER TABLE orden ADD CONSTRAINT orden_cupon_id_cupon_id FOREIGN KEY (cupon_id) REFERENCES cupon(id);
ALTER TABLE plato_translation ADD CONSTRAINT plato_translation_id_plato_id FOREIGN KEY (id) REFERENCES plato(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE plato ADD CONSTRAINT plato_categoria_id_categoria_id FOREIGN KEY (categoria_id) REFERENCES categoria(id);
ALTER TABLE preferenciastipoingrediente ADD CONSTRAINT ptti FOREIGN KEY (tipoingrediente_id) REFERENCES tipoingrediente(id);
ALTER TABLE preferenciastipoingrediente ADD CONSTRAINT preferenciastipoingrediente_usuario_id_usuario_id FOREIGN KEY (usuario_id) REFERENCES usuario(id) ON DELETE CASCADE;
ALTER TABLE testimonio ADD CONSTRAINT testimonio_usuario_id_usuario_id FOREIGN KEY (usuario_id) REFERENCES usuario(id);
ALTER TABLE tipoingrediente_translation ADD CONSTRAINT tipoingrediente_translation_id_tipoingrediente_id FOREIGN KEY (id) REFERENCES tipoingrediente(id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE usuario ADD CONSTRAINT usuario_comoseentero_id_comoseentero_id FOREIGN KEY (comoseentero_id) REFERENCES comoseentero(id);
